<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>디맨드 근무 후기 이벤트</title>
  <link href="https://cdn.jsdelivr.net/npm/pretendard@1.3.6/dist/web/static/pretendard.css" rel="stylesheet">
  <style>
    /* === 생략된 CSS는 이전과 동일 === */
    body {
      font-family: 'Pretendard', sans-serif;
      background: #f7f9fc;
      padding: 3rem 1rem;
      margin: 0;
    }
    .container {
      max-width: 720px;
      margin: auto;
      background: #ffffff;
      padding: 2rem 1.5rem;
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }
    /* ... (생략된 CSS 전체 포함되어 있음) ... */
  </style>
</head>

<body>
  <!-- 1단계 -->
  <div class="container" id="page1">
    <h1>근무 후기 이벤트 참여</h1>
    <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>
    <div class="step-indicator">1 / 3</div>
    <form onsubmit="event.preventDefault(); showPage(2);">
      <label>이름</label>
      <input type="text" name="name" required>
      <label>이메일</label>
      <input type="email" name="email" required>
      <label>전화번호</label>
      <input type="tel" name="phone" required>
      <label>어떤 경로로 후기 이벤트를 접하게 되었나요?</label>
      <select name="source" required>
        <option value="">선택해주세요</option>
        <option>디맨드 홈페이지</option>
        <option>디맨드 인스타그램</option>
        <option>디맨드 스레드</option>
        <option>디맨드 오픈채팅방</option>
        <option>인스타그램 광고</option>
        <option>디맨드 블로그</option>
        <option>기타</option>
      </select>
      <label>최종학력</label>
      <select name="education" required>
        <option value="">선택해주세요</option>
        <option>고졸</option>
        <option>초대졸</option>
        <option>대졸</option>
      </select>
      <label>회사명</label>
      <input type="text" name="company" required>
      <label>사업장 주소</label>
      <div class="flex-row">
        <input type="text" id="postcode" placeholder="우편번호" readonly required>
        <button type="button" onclick="execDaumPostcode()">주소 찾기</button>
      </div>
      <input type="text" id="roadAddress" placeholder="도로명 주소" readonly required>
      <input type="text" id="detailAddress" placeholder="상세주소 입력" required>
      <label>근무 형태</label>
      <select name="worktype" required>
        <option value="현직장">현직장</option>
        <option value="전직장">전직장</option>
      </select>
      <label>직무</label>
      <select name="jobtype" required>
        <option>생산</option>
        <option>공무</option>
        <option>설비</option>
        <option>환경안전</option>
        <option>물류</option>
        <option>품질</option>
        <option>건설/공사/프로젝트</option>
        <option>설계/CAD/CAM</option>
        <option>시설관리</option>
        <option>기타</option>
      </select>
      <label><input type="checkbox" required> 개인정보 수집 및 활용에 동의합니다.</label>
      <button type="submit" class="next-btn">다음 (1/3)</button>
    </form>
  </div>

  <!-- 2단계 -->
  <div class="container hidden" id="page2">
    <h1>현직자 인증</h1>
    <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>
    <div class="step-indicator">2 / 3</div>
    <p>증빙자료를 업로드해주세요. (예: 사원증, 사내 시스템 화면 등)</p>
    <form onsubmit="event.preventDefault(); showPage(3);">
      <div class="upload-section">
        <input type="file" name="proof" accept="image/*,application/pdf" required>
      </div>
      <button type="button" class="prev-btn" onclick="showPage(1)">이전</button>
      <button type="submit" class="next-btn">다음 (2/3)</button>
    </form>
  </div>

  <!-- 3단계 -->
  <div class="container hidden" id="page3">
    <h1>현직자 상세 리뷰</h1>
    <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>
    <div class="step-indicator">3 / 3</div>
    <form onsubmit="event.preventDefault(); alert('제출 완료!');">
      <div id="reviewItems"></div>
      <button type="button" class="prev-btn" onclick="showPage(2)">이전</button>
      <button type="submit" class="submit-btn">제출하기</button>
    </form>
  </div>

  <!-- 주소 API 및 스크립트 -->
  <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <script>
    function showPage(n) {
      document.querySelectorAll('.container').forEach((c, i) => c.classList.toggle('hidden', i !== n - 1));
      document.querySelectorAll('.progress-bar').forEach(bar => bar.style.width = (n / 3 * 100) + "%");
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // ✅ 글로벌 등록 필요
    window.execDaumPostcode = function () {
      new daum.Postcode({
        oncomplete: function(data) {
          document.getElementById('postcode').value = data.zonecode;
          document.getElementById('roadAddress').value = data.roadAddress;
          setTimeout(() => document.getElementById('detailAddress').focus(), 100);
        }
      }).open();
    };

    // 흔들림 효과
    document.querySelectorAll("form").forEach(form => {
      form.addEventListener("submit", (e) => {
        const invalid = form.querySelector(":invalid");
        if (invalid) {
          e.preventDefault();
          const container = form.closest(".container");
          container.classList.remove("shake");
          void container.offsetWidth;
          container.classList.add("shake");
        }
      });
    });

    // 후기 항목 생성
    const reviewData = [
      { title: "근무환경/시설" },
      { title: "근무강도/스트레스" },
      { title: "급여/복지" },
      { title: "안정성/전망" },
      { title: "사람들" },
      { title: "취업준비", isDifficulty: true },
      { title: "면접준비", isDifficulty: true },
      { title: "이 곳에서 일하게 될 사람들에게 한마디" }
    ];

    const container = document.getElementById("reviewItems");
    reviewData.forEach((item, idx) => {
      const section = document.createElement("div");
      let content = `<label>${idx + 1}. ${item.title}</label>`;

      if (item.isDifficulty) {
        content += `
          <label>난이도 평가</label>
          <select required>
            <option value="">선택</option>
            <option value="1">1 (쉬움)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4 (어려움)</option>
          </select>
        `;
      } else if (!item.title.includes("한마디")) {
        content += `
          <div class="rating-stars">
            <input type="radio" id="${item.title}-star5" name="${item.title}" value="5" required><label for="${item.title}-star5">★</label>
            <input type="radio" id="${item.title}-star4" name="${item.title}" value="4"><label for="${item.title}-star4">★</label>
            <input type="radio" id="${item.title}-star3" name="${item.title}" value="3"><label for="${item.title}-star3">★</label>
            <input type="radio" id="${item.title}-star2" name="${item.title}" value="2"><label for="${item.title}-star2">★</label>
            <input type="radio" id="${item.title}-star1" name="${item.title}" value="1"><label for="${item.title}-star1">★</label>
          </div>
        `;
      }

      content += `
        <label>상세 리뷰 *</label>
        <textarea rows="4" minlength="50" required placeholder="최소 50자 이상 입력"></textarea>
      `;

      section.innerHTML = content;
      container.appendChild(section);
    });
  </script>
</body>
</html>
